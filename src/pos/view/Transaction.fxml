<?xml version="1.0" encoding="UTF-8"?>

<?import java.net.URL?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>

<AnchorPane fx:id="transactionBody"
            prefHeight="700.0" prefWidth="1190.0"
            xmlns="http://javafx.com/javafx/24.0.1"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="pos.controller.TransactionController"
            styleClass="root">

    <stylesheets>
        <URL value="@/pos/css/transaction.css" />
    </stylesheets>

    <children>
        <VBox spacing="14"
              AnchorPane.topAnchor="0.0" AnchorPane.bottomAnchor="0.0"
              AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0"
              styleClass="content">

            <!-- Shopee-like top bar -->
            <HBox alignment="CENTER_LEFT" spacing="12" styleClass="topbar">
                <Label text="Transaction" styleClass="title"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button text="Logout" onAction="#handleLogout" styleClass="btn-topbar"/>
            </HBox>

            <SplitPane dividerPositions="0.64" VBox.vgrow="ALWAYS" styleClass="splitpane">

                <!-- LEFT: Products -->
                <VBox spacing="12" styleClass="panel">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label text="Products" styleClass="section-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <TextField fx:id="txtSearch"
                                   promptText="Search products..."
                                   onKeyReleased="#searchProducts"
                                   styleClass="field"
                                   maxWidth="360"/>
                    </HBox>

                    <TableView fx:id="productTable" VBox.vgrow="ALWAYS" styleClass="table">
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                        <columns>
                            <TableColumn fx:id="pIdCol" text="ID" />
                            <TableColumn fx:id="pNameCol" text="Product" />
                            <TableColumn fx:id="pPriceCol" text="Price" />
                            <TableColumn fx:id="pDiscountCol" text="Disc" />
                            <TableColumn fx:id="pStockCol" text="Stock" />
                            <TableColumn fx:id="pTypeCol" text="Type" />
                            <TableColumn fx:id="pActionCol" text="" />
                        </columns>
                    </TableView>
                </VBox>

                <!-- RIGHT: Cart -->
                <VBox spacing="12" styleClass="panel">
                    <HBox alignment="CENTER_LEFT">
                        <Label text="Cart" styleClass="section-title"/>
                    </HBox>

                    <TableView fx:id="cartTable" VBox.vgrow="ALWAYS" styleClass="table">
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                        <columns>
                            <TableColumn fx:id="cNameCol" text="Item" />
                            <TableColumn fx:id="cQtyCol" text="Qty" />
                            <TableColumn fx:id="cPriceCol" text="Price" />
                            <TableColumn fx:id="cDiscCol" text="Disc" />
                            <TableColumn fx:id="cSubCol" text="Subtotal" />
                            <TableColumn fx:id="cRemoveCol" text="" />
                        </columns>
                    </TableView>

                    <!-- Summary -->
                    <VBox spacing="10" styleClass="summary">
                        <HBox alignment="CENTER_RIGHT" spacing="10">
                            <Label text="Total" styleClass="muted"/>
                            <Label fx:id="lblTotal" text="0.00" styleClass="total"/>
                        </HBox>

                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="Customer" styleClass="muted" prefWidth="78"/>
                            <ComboBox fx:id="cmbCustomer"
                                      promptText="Walk-in / select"
                                      styleClass="field"
                                      maxWidth="Infinity"/>
                        </HBox>

                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="Payment" styleClass="muted" prefWidth="78"/>
                            <TextField fx:id="txtPayment"
                                       promptText="0.00"
                                       onKeyReleased="#computeChange"
                                       styleClass="field"
                                       prefWidth="170"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label text="Change" styleClass="muted"/>
                            <Label fx:id="lblChange" text="0.00" styleClass="value"/>
                        </HBox>

                        <Button text="Checkout"
                                onAction="#checkout"
                                prefHeight="44"
                                maxWidth="Infinity"
                                styleClass="btn-primary"/>
                    </VBox>

                </VBox>

            </SplitPane>
        </VBox>
    </children>
</AnchorPane>

